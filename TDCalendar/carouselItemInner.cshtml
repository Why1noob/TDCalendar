@using System.Data
@using System.Data.OleDb
@using System.Globalization
<div class="row">
    <div class="row" id="carousel-item-header">
        <div class="col-sm-10 invisible">a</div>
        <div class="col-sm-2 text-center" id="date" style="font-weight: bold">@{ var date = DateTime.Now.ToString("dd-MM-yyyy"); }</div>
    </div>
    <div class="row">
        <div class="col-ms-12 invisible">a </div>
    </div>
<div class="col-sm-12">
    <div class="col-sm-2">
        <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
            <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
    </div>
    <div class="row col-sm-8">
       @{
           
            const string connectionString = @"Provider=Microsoft.ACE.OLEDB.15.0;Data Source=C:/projects/ToDoCalendar/TDCalendar/TDCalendar/TDC.accdb; Persist Security Info=False;";
            var query = "SELECT * FROM Tasks WHERE PlannedDate = #" + date + "#;";
            var ds = new DataSet();
            var con = new OleDbConnection(connectionString);
            try
            {
                
                con.Open();
                var da = new OleDbDataAdapter(query, con);
                da.Fill(ds, "Tasks");
                var numerator = 1;
                for (var c = 0; c < ds.Tables["Tasks"].Rows.Count;c++)
                {    
                    <div class="row col-sm-12">
                        <div class="col-sm-11 text-center alert alert-info"><strong>@numerator.ToString(CultureInfo.InvariantCulture)+" "</strong><span>@ds.Tables["Tasks"].Rows[c]["Task"]<</span></div>
                        @{
                            if ((bool) ds.Tables["Tasks"].Rows[c]["Completed"])
                            {
                                <div class="col-sm-1"><input type="checkbox" checked="checked" value="" disabled="disabled" class="disabled" /></div>
                            }
                            else
                            {
                                <div class="col-sm-1"><input type="checkbox" value="" disabled="disabled" class="disabled" /></div>
                            }
                        }
                    </div>
                    numerator++;
                }
                con.Close();
            }
            catch (Exception ex)
            {
                Response.Write(@"<script>alert('DB Error:"+ex+"');</script>");
            }
        }
       }
         <div class="row col-sm-12">
                  <div class="col-sm-11 text-center alert alert-info">%Task1</div>
                  <div class="col-sm-1"><input type="checkbox" value="" disabled="disabled" class="disabled" /></div>
              </div>
            <div class="row col-sm-12">
                <div class="col-sm-11 text-center alert alert-info">%Task2</div>
                <div class="col-sm-1"><input type="checkbox" value="" disabled="disabled" class="disabled" /></div>
            </div>
            <div class="col-ms-12 invisible">a</div>
        </div>

        <div class="col-sm-2">
            <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
                <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </div>
</div>